---
name: sjw-development-workflow
description: 灵活编排需求分析、功能设计、编码实现三个子 skills。支持完整流程或按需执行单个阶段，适用于新功能开发、bug分析修复、代码优化重构等场景。当用户说"开始开发流程"、"分析这个问题"、"设计这个功能"或需要结构化开发支持时使用。
---

# SJW 开发工作流编排器

## 概述

本技能灵活协调三个子 skills（sjw-requirement-analysis、sjw-feature-design、sjw-feature-code），可以根据实际需求：

- **完整流程** - 需求→设计→代码，端到端完成
- **单阶段执行** - 只执行需求分析、功能设计或编码实现
- **灵活组合** - 跳过某些阶段，按需执行

**适用场景:**
- 🆕 新功能开发（完整流程）
- 🐛 Bug分析和修复（需求分析→编码）
- 🔧 代码优化重构（需求分析→功能设计）
- 📝 功能设计文档生成（仅功能设计）
- 💡 需求梳理和拆解（仅需求分析）

## 快速开始

**根据任务类型自动选择执行策略:**

```
场景1: 新功能开发
用户: 实现用户权限管理功能
→ 执行: 需求分析 → 功能设计 → 编码实现

场景2: Bug分析修复
用户: 分析并修复登录失败的问题
→ 执行: 需求分析(分析问题) → 编码实现

场景3: 仅设计
用户: 设计一个订单管理模块
→ 执行: 功能设计

场景4: 需求梳理
用户: 梳理支付系统的需求
→ 执行: 需求分析
```

## 核心能力

1. **工作流编排** - 协调三个子 skills 的执行顺序和数据流转
2. **灵活执行模式** - 支持全自动、分步执行、混合模式
3. **项目进度跟踪** - 实时跟踪项目进度和任务完成情况
4. **质量门禁检查** - 每个阶段完成后进行质量验证
5. **文档管理** - 统一管理所有输出文档和代码
6. **迭代优化建议** - 基于执行结果提供改进建议
7. **自我进化** - 根据执行结果质量反向优化子 skills

## 工作流程架构

```
用户需求
    ↓
┌─────────────────────────────────────────┐
│   sjw-development-workflow (编排器)       │
│                                         │
│  ┌───────────────────────────────────┐  │
│  │ 执行模式选择                      │  │
│  │ ○ 全自动模式                     │  │
│  │ ○ 分步执行模式                   │  │
│  │ ○ 混合模式                       │  │
│  └───────────────────────────────────┘  │
│                                         │
│  ┌───────────────────────────────────┐  │
│  │ 质量门禁检查                      │  │
│  │ ○ 需求分析质量检查                │  │
│  │ ○ 功能设计质量检查                │  │
│  │ ○ 编码实现质量检查                │  │
│  └───────────────────────────────────┘  │
│                                         │
│  ┌───────────────────────────────────┐  │
│  │ 项目进度跟踪                      │  │
│  │ ○ 任务完成度                      │  │
│  │ ○ 质量评分                        │  │
│  │ ○ 风险和问题                      │  │
│  └───────────────────────────────────┘  │
│                                         │
│  ┌───────────────────────────────────┐  │
│  │ 文档管理                          │  │
│  │ ○ 文档清单                        │  │
│  │ ○ 版本管理                        │  │
│  │ ○ 文档关联                        │  │
│  └───────────────────────────────────┘  │
│                                         │
│  ┌───────────────────────────────────┐  │
│  │ 迭代优化                          │  │
│  │ ○ 执行结果分析                    │  │
│  │ ○ 改进建议生成                    │  │
│  │ ○ 子 skill 优化                   │  │
│  └───────────────────────────────────┘  │
└─────────────────────────────────────────┘
    ↓                    ↓                  ↓
需求分析 ←--------→ 功能设计 ←----------→ 编码实现
    ↓                    ↓                  ↓
需求文档           设计文档            可运行代码
```

## 执行模式

### 模式选择策略

**根据场景自动选择:**

| 场景 | 推荐模式 | 说明 |
|------|---------|------|
| 需求明确，快速交付 | 全自动 | 依次执行，遇质量问题暂停 |
| 需求复杂，需要确认 | 分步执行 | 每步完成后等待用户确认 |
| 平衡效率和质量 | 混合模式 | 关键步骤确认，其他自动执行 |
| 仅分析问题 | 单阶段 | 只执行需求分析 |
| 仅设计功能 | 单阶段 | 只执行功能设计 |
| 只生成代码 | 单阶段 | 只执行编码实现 |

### 模式 1：全自动模式

- **适用:** 需求明确完整，时间紧迫
- **流程:** 依次调用子skills → 每步质量检查 → 遇问题暂停 → 完成后生成报告
- **优点:** 快速高效，人工干预少

### 模式 2：分步执行模式

- **适用:** 需求复杂，用户希望深度参与
- **流程:** 执行一步 → 展示结果 → 等待确认 → 继续下一步
- **优点:** 每步可调整，适合复杂项目

### 模式 3：混合模式

- **适用:** 平衡效率和灵活性（推荐）
- **流程:** 明确步骤自动执行，关键步骤等待确认
- **优点:** 关键步骤有人工把关

---

## 工作流程详解

### 阶段 1：流程初始化

1. **需求收集**
   - 获取用户需求描述
   - **提取需求关键词**（2-6个字，用于文档目录命名）
   - 了解项目背景和约束

2. **模式选择**
   - 根据需求清晰度推荐执行模式
   - 参考上文的"模式选择策略"表格

3. **创建文档目录结构** ⚠️ 重要

**目录命名规则:** `[需求关键词]-项目文档/`

**标准目录结构:**
```
[需求名称]-项目文档/
├── 00-项目管理/           # 进度跟踪、质量检查、总结报告
├── 01-需求分析阶段/       # 需求分析文档
├── 02-功能设计阶段/       # 功能设计文档
└── 03-编码实现阶段/       # 实现指南、影响范围分析
```

**创建命令:**
```bash
# 创建项目文档目录
mkdir -p "[需求名称]-项目文档"/{00-项目管理,01-需求分析阶段,02-功能设计阶段,03-编码实现阶段}

# 验证创建成功
[ -d "[需求名称]-项目文档" ] && echo "✅ 目录创建成功" || echo "❌ 目录创建失败"
```

4. **初始化进度跟踪**
   - 创建 `00-项目管理/项目进度跟踪.md`
   - 设置质量门禁标准
   - 将文档路径传递给子skills

---

### 阶段 2：需求分析阶段

**调用子 skill：** 使用 `Skill` 工具调用 `sjw-requirement-analysis`

**执行前检查：**
- [ ] 需求描述是否完整
- [ ] 是否需要额外的上下文信息
- [ ] 是否需要访问现有代码库

**执行过程：**
1. 使用 Skill 工具触发需求分析
2. 监控执行进度
3. 收集生成的文档
4. 记录执行时间和质量指标

**质量门禁检查：**
- [ ] 业务目标清晰明确
- [ ] 功能需求拆解完整
- [ ] 非功能性需求已识别
- [ ] 技术考虑合理可行
- [ ] 风险已识别并有缓解策略
- [ ] 文档结构完整

**质量评分：** ___ / 5.0（通过标准: ≥4.0）

**执行后处理：**
- 验证文档已创建: `[ -f "$REQUIREMENT_PATH/需求分析文档.md" ] && echo "✅" || echo "❌"`
- 更新项目进度跟踪文档
- 将需求分析文档保存到 `$REQUIREMENT_PATH/需求分析文档.md`

---

### 阶段 3：功能设计阶段

**调用子 skill：** 使用 `Skill` 工具调用 `sjw-feature-design`

**执行前检查：**
- [ ] 需求分析文档是否通过质量检查
- [ ] 是否有项目技术栈信息
- [ ] 是否需要分析现有代码

**执行过程：**
1. 传递需求分析文档路径给设计 skill
2. 监控执行进度
3. 收集生成的文档
4. 记录执行时间和质量指标

**质量门禁检查：**
- [ ] 模块划分清晰合理
- [ ] 数据模型设计完整（ERD、表结构）
- [ ] API 接口定义完整（RESTful 规范）
- [ ] 业务流程设计合理（流程图、状态机）
- [ ] 性能和安全考虑周全
- [ ] 技术实现方案可行

**质量评分：** ___ / 5.0（通过标准: ≥4.0）

**执行后处理：**
- 验证文档已创建: `[ -f "$DESIGN_PATH/功能设计文档.md" ] && echo "✅" || echo "❌"`
- 更新项目进度跟踪文档
- 将功能设计文档保存到 `$DESIGN_PATH/功能设计文档.md`

---

### 阶段 4：编码实现阶段

**调用子 skill：** 使用 `Skill` 工具调用 `sjw-feature-code`

**执行前检查：**
- [ ] 功能设计文档是否通过质量检查
- [ ] 是否有现有项目代码
- [ ] 是否需要遵循特定的代码规范

**执行过程：**
1. 传递功能设计文档路径给编码 skill
2. 监控执行进度
3. 收集生成的代码和文档
4. 记录执行时间和质量指标

**质量门禁检查：**

**文件创建验证（必须完成）:**
- [ ] **实际代码文件已创建** - 使用 Write 工具创建实际的 .java 等代码文件
- [ ] **配置文件已创建** - pom.xml、application.yml 等
- [ ] **数据库脚本已创建** - SQL 迁移脚本
- [ ] **核心模块完整** - 完整的业务模块（Entity + Mapper + Service + Controller）
- [ ] **文档已创建** - 实现指南和影响范围分析

**代码质量检查:**
- [ ] 代码遵循最佳实践（如 Spring Boot）
- [ ] 代码结构清晰（分层合理）
- [ ] 异常处理完整
- [ ] 事务管理正确
- [ ] 代码注释完整
- [ ] 影响范围分析完整

**质量评分：** ___ / 5.0（通过标准: ≥4.0）

**执行后处理：**
- 验证文档已创建:
  ```bash
  [ -f "$IMPLEMENTATION_PATH/实现指南.md" ] && [ -f "$IMPLEMENTATION_PATH/影响范围分析.md" ] && echo "✅" || echo "❌"
  ```
- 更新项目进度跟踪文档
- 将文档保存到相应目录

---

### 阶段 5：项目总结和优化

**项目总结报告应包含:**
- 项目概况（名称、周期、执行模式）
- 各阶段执行情况（时间、评分、输出、问题）
- 整体质量评估（总分、成就、改进项）
- 下一步行动

---

## 项目进度跟踪

### 进度文档结构

在项目启动时创建进度跟踪文档：

```markdown
# [项目名称] 开发进度跟踪

**创建时间：** [时间戳]
**执行模式：** [模式]
**当前阶段：** [阶段]

## 进度概览
| 阶段 | 状态 | 完成度 | 开始时间 | 完成时间 | 质量评分 |
|------|------|--------|----------|----------|----------|
| 需求分析 | 🔄 进行中 | 50% | [时间] | - | - |
| 功能设计 | ⬜ 未开始 | 0% | - | - | - |
| 编码实现 | ⬜ 未开始 | 0% | - | - | - |

## 详细进度
[每个阶段的详细进度]

## 质量门禁记录
[每个阶段的质量检查记录]

## 风险和问题
[遇到的风险和问题]

## 文档清单
[所有输出文档列表]
```

### 实时更新机制

在执行过程中实时更新进度：
- 每个阶段开始时更新状态
- 完成时记录时间和质量评分
- 遇到问题时记录问题和解决方案
- 生成报告时更新整体进度

---

## 质量门禁系统

### 质量评分标准（总分5.0，通过标准: ≥4.0）

**需求分析质量评分:**
| 评分项 | 权重 | 评分标准 |
|--------|------|----------|
| 业务目标明确性 | 20% | 5-非常明确且可衡量 → 1-不明确 |
| 功能需求完整性 | 30% | 5-完整覆盖所有场景 → 1-严重缺失 |
| 非功能需求识别 | 20% | 5-全面识别性能、安全 → 1-未识别 |
| 技术可行性 | 15% | 5-完全可行且有方案 → 1-不可行 |
| 风险识别和缓解 | 15% | 5-完整识别并有方案 → 1-未识别 |

**功能设计质量评分:**
| 评分项 | 权重 | 评分标准 |
|--------|------|----------|
| 模块划分合理性 | 25% | 5-清晰的模块边界 → 1-混乱 |
| 数据模型完整性 | 25% | 5-完整的ERD和表设计 → 1-未设计 |
| API 设计规范性 | 25% | 5-符合RESTful规范 → 1-未设计 |
| 业务流程设计 | 15% | 5-完整的流程图和状态机 → 1-未设计 |
| 性能和安全考虑 | 10% | 5-全面的性能和安全设计 → 1-未考虑 |

**编码实现质量评分:**
| 评分项 | 权重 | 评分标准 |
|--------|------|----------|
| 文件创建完整性 | 30% | 5-所有必需文件已创建 → 1-未创建 |
| 代码规范遵循度 | 25% | 5-完全遵循规范 → 1-完全不遵循 |
| 测试覆盖率 | 20% | 5->80% → 1-≤50% |
| 异常处理完整性 | 15% | 5-完整的异常处理和日志 → 1-未处理 |
| 文档完整性 | 10% | 5-完整的实现指南和影响分析 → 1-无文档 |

### 质量检查流程

1. **自动检查** - 文档结构、必需字段、格式规范
2. **人工审查** - 内容质量、技术合理性、可行性评估
3. **质量评分** - 根据标准打分，记录评分依据
4. **改进反馈** - 不通过时提供改进建议

---

## 文档管理系统

### 文档分类

```
项目文档/
├── 01-需求分析阶段/
│   ├── 需求分析文档.md
│   ├── 用户故事列表.md
│   └── 验收标准.md
├── 02-功能设计阶段/
│   ├── 功能设计文档.md
│   ├── 数据模型设计.md
│   ├── API接口文档.md
│   └── 业务流程图.md
├── 03-编码实现阶段/
│   ├── 源代码/
│   ├── 数据库脚本/
│   ├── 测试用例/
│   └── 影响范围分析.md
└── 04-项目管理/
    ├── 项目进度跟踪.md
    ├── 质量检查报告.md
    └── 项目总结报告.md
```

### 文档版本管理

- 每次修改都记录版本号
- 保留历史版本
- 记录变更内容
- 关联相关文档

### 文档关联

记录文档之间的依赖关系：
- 功能设计文档依赖需求分析文档
- 编码实现依赖功能设计文档
- 测试用例依赖需求和设计文档

---

## 迭代优化和自我进化

### 执行结果分析

在每个项目完成后分析：

**分析维度:**
1. **执行效率** - 总时间、各阶段耗时、等待时间
2. **输出质量** - 质量评分、问题统计、返工次数
3. **用户满意度** - 用户反馈、调整请求、验收通过率
4. **问题统计** - 问题类型、发生频率、解决时间

### 改进建议生成

**针对子 skills 的改进:**
- 识别高频问题
- 提供具体的 SKILL.md 修改建议
- 说明改进理由和预期效果
- 标记优先级（高/中/低）

**针对工作流程的改进:**
- 分析流程瓶颈
- 提出流程优化建议
- 评估效率和质量的提升
- 制定实施计划

### 优化循环

```
执行项目 → 收集反馈 → 分析问题 → 生成建议
   ↑                                              ↓
   ←──────────── 验证效果 ← 应用优化 ← 更新SKILL.md
```

**优化记录应包含:**
- 优化内容、时间、效果
- 后续验证结果

---

## 最佳实践

### 对于编排器

1. **灵活适应** - 根据项目特点调整执行模式
2. **透明沟通** - 清晰展示进度、及时报告问题
3. **质量优先** - 严格执行质量门禁，不盲目追求速度
4. **持续改进** - 每个项目收集反馈，主动优化子skills

### 对于用户

1. **明确需求** - 清晰描述需求，提供足够上下文
2. **及时反馈** - 及时确认或调整输出，提供具体建议
3. **质量把关** - 认真进行质量检查，不降低标准
4. **参与优化** - 提供使用反馈，帮助验证优化效果

---

## 质量检查清单（编排器自身）

在使用本编排器时，验证：

- [ ] 已向用户说明执行模式和流程
- [ ] 项目进度跟踪文档已创建
- [ ] 质量门禁标准已明确
- [ ] 每个阶段执行前已进行前检查
- [ ] 每个阶段执行后已进行质量检查
- [ ] 所有文档已加入文档管理系统
- [ ] 项目总结报告已生成
- [ ] 优化建议已记录
- [ ] 用户已确认项目完成
