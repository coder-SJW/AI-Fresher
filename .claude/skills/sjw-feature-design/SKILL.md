---
name: sjw-feature-design
description: 本技能用于根据需求分析文档进行功能设计，生成结构化的功能设计说明文档。当用户要求"进行功能设计"、"生成设计文档"、"基于需求文档设计功能"或需要功能编码实现指导时，使用此技能。
---

# SJW 功能设计

## 概述

将需求分析文档转化为包含功能模块、数据模型、API接口、业务流程的完整功能设计文档。

## 输入参数

**必需参数：**
- `requirement_doc_path` - 需求分析文档路径

**可选参数：**
- `design_doc_path` - 输出路径（默认：当前目录）
- `tech_stack` - 技术栈（默认：从项目推断）
- `explore_codebase` - 是否探索现有代码（默认：false）

**Workflow 调用时：**
- 输入：`$REQUIREMENT_PATH/需求分析文档.md`
- 输出：`$DESIGN_PATH/功能设计文档.md`

## 执行流程

1. **读取需求文档** - 使用 Read 工具分析需求
2. **探索项目（可选）** - 使用 Explore agent 了解现有架构
3. **功能模块设计** - 模块划分、职责定义、依赖关系
4. **数据模型设计** - 实体设计、字段定义、关系映射
5. **API 接口设计** - RESTful API 定义、请求响应格式
6. **业务流程设计** - 核心流程、状态机、时序图
7. **输出设计文档** - 使用 Write 工具生成文档

## 设计要点

### 功能模块设计
- 模块划分：单一职责、高内聚低耦合
- 模块职责：核心功能列表、接口定义、依赖关系
- 架构图：使用 Mermaid 绘制模块层次和依赖关系

### 数据模型设计
- 实体定义：字段名、类型、约束、索引
- 关系映射：一对一、一对多、多对多
- 数据字典：完整字段说明和枚举值
- ER 图：实体关系可视化

### API 接口设计
- 端点定义：方法、路径、参数、响应
- 请求示例：JSON 格式的请求体
- 错误码：标准 HTTP 状态码和业务错误码
- 安全规范：认证、授权、限流

### 业务流程设计
- 流程步骤：触发条件、操作序列、异常处理
- 状态机：状态定义和转换规则
- 时序图：组件交互流程

## 输出文档模板

```markdown
# [项目名称]功能设计文档

## 1. 设计概述
- 设计目标和范围
- 技术栈

## 2. 功能模块设计
- 模块划分和职责
- 模块依赖图（Mermaid）

## 3. 数据模型设计
- 实体定义和字段
- 实体关系图（ERD）

## 4. API 接口设计
- 接口列表和定义
- 请求响应示例

## 5. 业务流程设计
- 核心流程图
- 状态机定义
- 时序图

## 6. 非功能性设计
- 性能、安全、可扩展性

## 7. 技术实现要点
- 关键技术点
- 代码组织结构

## 8. 测试策略
- 单元测试、集成测试
```

## 设计原则

- **SOLID**：单一职责、开闭原则、依赖倒置
- **DRY**：避免重复，提取公共逻辑
- **KISS**：保持简单，避免过度设计
- **YAGNI**：只设计当前需要的功能

## 设计检查清单

- [ ] 覆盖所有需求文档功能点
- [ ] 模块职责清晰，耦合度低
- [ ] 数据模型合理，关系明确
- [ ] API 定义完整，符合规范
- [ ] 业务流程考虑边界情况
- [ ] 非功能性需求已考虑
- [ ] 文档清晰可实施
