# CRM 客户管理系统功能设计文档

**文档版本：** 1.0
**最后更新：** 2026-01-12
**作者：** AI 助手
**基于需求文档：** 需求分析文档 v1.0

---

## 文档变更历史

| 版本 | 日期 | 作者 | 变更说明 |
|------|------|------|----------|
| 1.0  | 2026-01-12 | AI 助手 | 初始版本 |

---

## 1. 设计概述

### 1.1 设计目标

本设计文档旨在为 CRM 客户管理系统后台提供完整的技术实施方案，确保：

- **功能完整性**：覆盖所有需求文档中定义的功能点
- **架构合理性**：采用分层架构，模块职责清晰，易于维护和扩展
- **技术可行性**：基于 Spring Boot + MyBatis-Plus + MySQL 技术栈，确保实施可行
- **性能优化**：通过合理的设计（索引、缓存、分页）满足性能要求
- **安全可靠**：实现完整的认证授权机制，保障数据安全

### 1.2 设计范围

**范围内：**
- ✅ 客户管理模块（客户 CRUD、高级查询、客户详情）
- ✅ 跟进记录模块（跟进 CRUD、跟进提醒）
- ✅ 销售机会模块（机会 CRUD、销售漏斗）
- ✅ 用户管理模块（用户 CRUD、登录认证、权限控制）
- ✅ 数据字典模块（字典 CRUD、字典缓存）
- ✅ 统一异常处理和响应封装
- ✅ 数据库设计和索引优化
- ✅ RESTful API 接口设计

**范围外：**
- ❌ 前端界面（Web/移动端）
- ❌ 消息推送（邮件、短信、微信）
- ❌ 报表统计和数据分析
- ❌ 文件上传和管理
- ❌ 客户导入导出
- ❌ 工作流引擎
- ❌ 第三方系统集成

### 1.3 技术栈

**后端框架：**
- Spring Boot 2.7.x（核心框架）
- Spring Security 5.7.x（安全框架）
- MyBatis-Plus 3.5.3（ORM 框架）
- MySQL Connector 8.0.28（数据库驱动）

**数据库：**
- MySQL 8.0.x（主数据库）
- Redis 6.x（缓存，可选）

**认证授权：**
- JWT (jjwt 0.9.1)（Token 认证）
- Spring Security（权限控制）

**工具库：**
- Lombok（代码简化）
- Hutool（工具类库）
- Validation（参数校验）
- Swagger 3.0（API 文档）

---

## 2. 功能模块设计

### 2.1 模块架构

采用分层架构 + 模块化设计：

```
crm-system/
├── crm-common/          # 公共模块
│   ├── crm-common-core/       # 核心工具类
│   ├── crm-common-security/   # 安全模块（JWT、权限）
│   └── crm-common-web/        # Web 模块（统一异常、统一响应）
│
├── crm-api/             # API 接口定义
│   ├── crm-api-customer/      # 客户 API
│   ├── crm-api-followup/      # 跟进记录 API
│   ├── crm-api-opportunity/   # 销售机会 API
│   └── crm-api-system/        # 系统 API（用户、字典）
│
└── crm-business/         # 业务实现模块
    ├── crm-customer/          # 客户管理模块
    ├── crm-followup/          # 跟进记录模块
    ├── crm-opportunity/       # 销售机会模块
    └── crm-system/            # 系统管理模块
```

### 2.2 模块详细设计

#### 2.2.1 crm-customer（客户管理模块）

**模块职责：**
- 客户信息的增删改查
- 客户列表查询和筛选
- 客户详情查看（含关联数据）
- 客户高级查询（多条件组合）

**主要功能：**
1. **客户创建** - 创建新客户记录
2. **客户查询** - 分页查询、条件筛选、模糊搜索
3. **客户详情** - 查看客户完整信息和关联数据
4. **客户编辑** - 更新客户信息
5. **客户删除** - 软删除客户（检查关联数据）

**接口定义：**
- `CustomerService` - 客户业务接口
- `CustomerController` - 客户 API 接口

**依赖关系：**
- 依赖：crm-common（公共模块）、crm-api-system（数据字典）
- 被依赖：crm-followup、crm-opportunity

**设计模式：**
- **服务层模式**：Service 层封装业务逻辑
- **DTO 模式**：使用 DTO 传输数据，隔离实体层

---

#### 2.2.2 crm-followup（跟进记录模块）

**模块职责：**
- 跟进记录的增删改查
- 跟进记录查询（按客户）
- 跟进提醒功能

**主要功能：**
1. **跟进记录创建** - 创建新的跟进记录
2. **跟进记录查询** - 按客户查询跟进记录
3. **跟进记录编辑** - 更新跟进内容
4. **跟进记录删除** - 软删除跟进记录
5. **跟进提醒** - 查询需要跟进的客户

**接口定义：**
- `FollowUpService` - 跟进记录业务接口
- `FollowUpController` - 跟进记录 API 接口

**依赖关系：**
- 依赖：crm-common、crm-customer（客户）、crm-api-system（用户、字典）

**设计模式：**
- **关联查询模式**：在查询跟进记录时关联查询客户信息

---

#### 2.2.3 crm-opportunity（销售机会模块）

**模块职责：**
- 销售机会的增删改查
- 销售漏斗统计
- 销售阶段推进

**主要功能：**
1. **销售机会创建** - 创建新的销售机会
2. **销售机会查询** - 分页查询、条件筛选
3. **销售机会编辑** - 更新机会信息
4. **销售阶段推进** - 推进销售阶段
5. **销售漏斗统计** - 按阶段统计机会和金额

**接口定义：**
- `OpportunityService` - 销售机会业务接口
- `OpportunityController` - 销售机会 API 接口

**依赖关系：**
- 依赖：crm-common、crm-customer（客户）、crm-api-system（字典）

**设计模式：**
- **统计模式**：使用聚合查询实现销售漏斗统计

---

#### 2.2.4 crm-system（系统管理模块）

**模块职责：**
- 用户管理
- 角色权限管理
- 数据字典管理
- 登录认证

**主要功能：**
1. **用户管理** - 用户 CRUD、密码重置、用户禁用
2. **登录认证** - JWT Token 生成和验证
3. **权限控制** - 基于角色的权限验证
4. **数据字典** - 字典 CRUD、字典缓存

**接口定义：**
- `UserService` - 用户业务接口
- `RoleService` - 角色业务接口
- `DictService` - 数据字典业务接口
- `AuthController` - 认证 API 接口

**依赖关系：**
- 依赖：crm-common

**设计模式：**
- **认证过滤器模式**：使用 JWT 过滤器验证请求
- **RBAC 模式**：基于角色的访问控制

---

### 2.3 模块依赖关系图

```
┌─────────────────────────────────────────────┐
│              crm-common                     │
│  (核心工具、安全、Web 基础设施)              │
└─────────────────────────────────────────────┘
                    ↑
                    │ 依赖
                    │
    ┌───────────────┼───────────────┐
    │               │               │
┌───┴────┐    ┌────┴────┐    ┌────┴────┐
│system  │    │customer │    │followup │
│模块    │◄───│模块     │◄───│模块     │
└────────┘    └────┬────┘    └─────────┘
                   │
                   │ 被依赖
                   │
              ┌────┴────┐
              │opportunity│
              │模块      │
              └─────────┘
```

---

## 3. 数据模型设计

### 3.1 实体关系图（ERD）

```
┌─────────────┐         ┌──────────────┐         ┌─────────────┐
│crm_user     │         │crm_customer  │         │crm_role     │
│─────────────│         │──────────────│         │─────────────│
│id (PK)      │         │id (PK)       │         │id (PK)      │
│username     │    ┌───►│customer_name │         │role_name    │
│password     │    │    │contact_name  │         │role_code    │
│real_name    │    │    │contact_phone │         └──────┬──────┘
│role_id (FK)│────┘    │customer_source│               │
│status       │         │customer_status│        ┌────┴──────┐
└─────────────┘         │...           │        │           │
                       └──────┬───────┘        │           │
                              │                │           │
                ┌─────────────┴───────────┐    │           │
                │                           │    │           │
         ┌──────┴───────┐          ┌──────┴────┴─┐          │
         │crm_follow_up │          │crm_opportunity◄─────────┘
         │─────────────│          │──────────────│
         │id (PK)      │          │id (PK)       │
         │customer_id  │          │customer_id   │
         │follow_up_...│          │opportunity...│
         │follow_person│          │sales_stage   │
         └─────────────┘          └──────────────┘

                ┌─────────────┐
                │crm_dict     │
                │─────────────│
                │id (PK)      │
                │dict_type    │
                │dict_label   │
                │dict_value   │
                └─────────────┘
```

### 3.2 数据表设计

#### 3.2.1 crm_user（用户表）

**表描述：** 存储系统用户信息

**字段列表：**

| 字段名 | 类型 | 长度 | 必填 | 默认值 | 说明 |
|--------|------|------|------|--------|------|
| id | BIGINT | - | 是 | - | 用户 ID（主键） |
| username | VARCHAR | 50 | 是 | - | 用户名（唯一） |
| password | VARCHAR | 100 | 是 | - | 密码（BCrypt 加密） |
| real_name | VARCHAR | 50 | 是 | - | 真实姓名 |
| phone | VARCHAR | 20 | 否 | - | 手机号 |
| email | VARCHAR | 100 | 否 | - | 邮箱 |
| role_id | BIGINT | - | 是 | - | 角色 ID（外键） |
| status | TINYINT | - | 是 | 1 | 状态（1:启用 0:禁用） |
| create_time | DATETIME | - | 是 | NOW() | 创建时间 |
| update_time | DATETIME | - | 是 | NOW() | 更新时间 |
| is_deleted | TINYINT | - | 是 | 0 | 删除标记（0:正常 1:删除） |
| version | INT | - | 是 | 0 | 乐观锁版本号 |

**索引设计：**
- PRIMARY KEY: `id`
- UNIQUE INDEX: `uk_username` ON (`username`)
- NORMAL INDEX: `idx_role_id` ON (`role_id`)
- NORMAL INDEX: `idx_status` ON (`status`)

**关系定义：**
- 多对一：用户属于角色（crm_role）

**数据验证规则：**
- username: 4-20 个字符，只能包含字母、数字、下划线
- password: 加密存储，明文长度 6-20 个字符
- phone: 手机号格式（11 位数字）
- email: 邮箱格式

---

#### 3.2.2 crm_role（角色表）

**表描述：** 存储系统角色信息

**字段列表：**

| 字段名 | 类型 | 长度 | 必填 | 默认值 | 说明 |
|--------|------|------|------|--------|------|
| id | BIGINT | - | 是 | - | 角色 ID（主键） |
| role_name | VARCHAR | 50 | 是 | - | 角色名称 |
| role_code | VARCHAR | 50 | 是 | - | 角色编码（唯一） |
| description | VARCHAR | 255 | 否 | - | 角色描述 |
| create_time | DATETIME | - | 是 | NOW() | 创建时间 |
| update_time | DATETIME | - | 是 | NOW() | 更新时间 |
| is_deleted | TINYINT | - | 是 | 0 | 删除标记 |

**索引设计：**
- PRIMARY KEY: `id`
- UNIQUE INDEX: `uk_role_code` ON (`role_code`)

**关系定义：**
- 一对多：角色拥有多个用户（crm_user）

**初始化数据：**
```sql
INSERT INTO crm_role (role_name, role_code, description) VALUES
('销售代表', 'SALES_REP', '负责客户跟进和销售机会管理'),
('销售经理', 'SALES_MANAGER', '负责销售团队管理和数据查看'),
('系统管理员', 'ADMIN', '负责系统配置和用户管理');
```

---

#### 3.2.3 crm_customer（客户表）

**表描述：** 存储客户信息

**字段列表：**

| 字段名 | 类型 | 长度 | 必填 | 默认值 | 说明 |
|--------|------|------|------|--------|------|
| id | BIGINT | - | 是 | - | 客户 ID（主键） |
| customer_name | VARCHAR | 100 | 是 | - | 客户名称 |
| contact_name | VARCHAR | 50 | 是 | - | 联系人姓名 |
| contact_phone | VARCHAR | 20 | 是 | - | 联系电话 |
| contact_email | VARCHAR | 100 | 否 | - | 联系邮箱 |
| company_address | VARCHAR | 255 | 否 | - | 公司地址 |
| customer_source | VARCHAR | 50 | 否 | - | 客户来源（字典值） |
| customer_status | VARCHAR | 20 | 是 | - | 客户状态（字典值） |
| remark | TEXT | - | 否 | - | 备注 |
| create_time | DATETIME | - | 是 | NOW() | 创建时间 |
| update_time | DATETIME | - | 是 | NOW() | 更新时间 |
| is_deleted | TINYINT | - | 是 | 0 | 删除标记 |
| version | INT | - | 是 | 0 | 乐观锁版本号 |

**索引设计：**
- PRIMARY KEY: `id`
- NORMAL INDEX: `idx_customer_name` ON (`customer_name`)
- NORMAL INDEX: `idx_contact_phone` ON (`contact_phone`)
- NORMAL INDEX: `idx_customer_status` ON (`customer_status`)
- NORMAL INDEX: `idx_customer_source` ON (`customer_source`)
- NORMAL INDEX: `idx_create_time` ON (`create_time`)

**关系定义：**
- 一对多：客户拥有多个跟进记录（crm_follow_up）
- 一对多：客户拥有多个销售机会（crm_opportunity）

**数据验证规则：**
- customer_name: 不允许为空，长度 1-100
- contact_phone: 手机号格式
- contact_email: 邮箱格式（如果提供）

---

#### 3.2.4 crm_follow_up（跟进记录表）

**表描述：** 存储客户跟进记录

**字段列表：**

| 字段名 | 类型 | 长度 | 必填 | 默认值 | 说明 |
|--------|------|------|------|--------|------|
| id | BIGINT | - | 是 | - | 记录 ID（主键） |
| customer_id | BIGINT | - | 是 | - | 客户 ID（外键） |
| follow_up_content | TEXT | - | 是 | - | 跟进内容 |
| follow_up_method | VARCHAR | 20 | 是 | - | 跟进方式（字典值） |
| next_follow_up_time | DATETIME | - | 否 | - | 下次跟进时间 |
| follow_up_person | BIGINT | - | 是 | - | 跟进人 ID（外键） |
| create_time | DATETIME | - | 是 | NOW() | 创建时间 |
| update_time | DATETIME | - | 是 | NOW() | 更新时间 |
| is_deleted | TINYINT | - | 是 | 0 | 删除标记 |

**索引设计：**
- PRIMARY KEY: `id`
- NORMAL INDEX: `idx_customer_id` ON (`customer_id`)
- NORMAL INDEX: `idx_follow_up_person` ON (`follow_up_person`)
- NORMAL INDEX: `idx_next_follow_up_time` ON (`next_follow_up_time`)
- NORMAL INDEX: `idx_create_time` ON (`create_time`)

**关系定义：**
- 多对一：跟进记录属于客户（crm_customer）
- 多对一：跟进记录属于跟进人（crm_user）

---

#### 3.2.5 crm_opportunity（销售机会表）

**表描述：** 存储销售机会信息

**字段列表：**

| 字段名 | 类型 | 长度 | 必填 | 默认值 | 说明 |
|--------|------|------|------|--------|------|
| id | BIGINT | - | 是 | - | 机会 ID（主键） |
| customer_id | BIGINT | - | 是 | - | 客户 ID（外键） |
| opportunity_name | VARCHAR | 200 | 是 | - | 机会名称 |
| estimated_amount | DECIMAL | 12,2 | 是 | - | 预计金额 |
| estimated_close_date | DATE | - | 是 | - | 预计成交日期 |
| sales_stage | VARCHAR | 50 | 是 | - | 销售阶段（字典值） |
| probability | INT | - | 否 | - | 成交概率（0-100） |
| remark | TEXT | - | 否 | - | 备注 |
| create_time | DATETIME | - | 是 | NOW() | 创建时间 |
| update_time | DATETIME | - | 是 | NOW() | 更新时间 |
| is_deleted | TINYINT | - | 是 | 0 | 删除标记 |
| version | INT | - | 是 | 0 | 乐观锁版本号 |

**索引设计：**
- PRIMARY KEY: `id`
- NORMAL INDEX: `idx_customer_id` ON (`customer_id`)
- NORMAL INDEX: `idx_sales_stage` ON (`sales_stage`)
- NORMAL INDEX: `idx_estimated_close_date` ON (`estimated_close_date`)
- NORMAL INDEX: `idx_create_time` ON (`create_time`)

**关系定义：**
- 多对一：销售机会属于客户（crm_customer）

---

#### 3.2.6 crm_dict（数据字典表）

**表描述：** 存储数据字典

**字段列表：**

| 字段名 | 类型 | 长度 | 必填 | 默认值 | 说明 |
|--------|------|------|------|--------|------|
| id | BIGINT | - | 是 | - | 字典 ID（主键） |
| dict_type | VARCHAR | 50 | 是 | - | 字典类型 |
| dict_label | VARCHAR | 100 | 是 | - | 字典标签 |
| dict_value | VARCHAR | 100 | 是 | - | 字典值 |
| sort_order | INT | - | 否 | 0 | 排序 |
| status | TINYINT | - | 是 | 1 | 状态（1:启用 0:禁用） |
| create_time | DATETIME | - | 是 | NOW() | 创建时间 |
| update_time | DATETIME | - | 是 | NOW() | 更新时间 |
| is_deleted | TINYINT | - | 是 | 0 | 删除标记 |

**索引设计：**
- PRIMARY KEY: `id`
- NORMAL INDEX: `idx_dict_type` ON (`dict_type`)
- UNIQUE INDEX: `uk_type_value` ON (`dict_type`, `dict_value`)

**初始化数据：**

```sql
-- 客户状态
INSERT INTO crm_dict (dict_type, dict_label, dict_value, sort_order) VALUES
('customer_status', '潜在客户', 'POTENTIAL', 1),
('customer_status', '意向客户', 'INTENTION', 2),
('customer_status', '成交客户', 'DEAL', 3),
('customer_status', '流失客户', 'LOST', 4);

-- 客户来源
INSERT INTO crm_dict (dict_type, dict_label, dict_value, sort_order) VALUES
('customer_source', '线上推广', 'ONLINE', 1),
('customer_source', '线下活动', 'OFFLINE', 2),
('customer_source', '客户转介绍', 'REFERRAL', 3),
('customer_source', '主动咨询', 'INQUIRY', 4),
('customer_source', '其他', 'OTHER', 5);

-- 跟进方式
INSERT INTO crm_dict (dict_type, dict_label, dict_value, sort_order) VALUES
('follow_up_method', '电话', 'PHONE', 1),
('follow_up_method', '微信', 'WECHAT', 2),
('follow_up_method', '邮件', 'EMAIL', 3),
('follow_up_method', '上门拜访', 'VISIT', 4),
('follow_up_method', '其他', 'OTHER', 5);

-- 销售阶段
INSERT INTO crm_dict (dict_type, dict_label, dict_value, sort_order) VALUES
('sales_stage', '线索确认', 'LEAD', 1),
('sales_stage', '需求分析', 'ANALYSIS', 2),
('sales_stage', '方案报价', 'PROPOSAL', 3),
('sales_stage', '谈判协商', 'NEGOTIATION', 4),
('sales_stage', '合同签署', 'CONTRACT', 5),
('sales_stage', '已成交', 'WON', 6);
```

### 3.3 数据字典

完整的数据字典见上述表设计。

### 3.4 数据一致性保证

**事务边界定义：**
- 单表 CRUD 操作：单事务
- 跨表操作（如删除客户时级联删除跟进记录）：使用 `@Transactional` 注解
- 查询操作：只读事务

**并发控制策略：**
- 使用乐观锁（version 字段）防止并发修改冲突
- 更新操作自动检查版本号，版本不匹配时抛出异常

**数据同步机制：**
- 数据字典在启动时加载到 Redis 缓存
- 提供 `@CacheEvict` 注解刷新缓存
- 缓存失效后自动重新查询数据库

---

## 4. API 接口设计

### 4.1 API 设计规范

**命名规范：**
- URL 使用小写字母和连字符（kebab-case）
- 资源使用复数形式（`/customers` 而非 `/customer`）
- 层级不超过 3 层（如 `/api/v1/customers/{id}/follow-ups`）

**版本管理：**
- URL 版本：`/api/v1/`, `/api/v2/`
- 向后兼容：不删除已有接口，标记为 `@Deprecated`

**分页规范：**
- 参数：`page`（页码，从 1 开始）、`size`（每页大小）
- 响应：包含 `records`（数据列表）、`total`（总数）、`current`（当前页）、`pages`（总页数）

**排序规范：**
- 参数：`sortField`（排序字段）、`sortOrder`（排序方向：asc/desc）

**过滤规范：**
- 使用查询参数进行过滤（如 `?customerStatus=DEAL`）
- 模糊搜索使用 `q` 参数（如 `?q=张三`）

**时间格式：**
- 使用 ISO 8601 格式：`2026-01-12T10:30:00+08:00`
- 日期格式：`2026-01-12`

**安全规范：**
- 除了登录接口，所有接口都需要在 Header 中携带 JWT Token
- Header: `Authorization: Bearer {token}`

### 4.2 API 接口列表

#### 4.2.1 认证接口

##### POST /api/v1/auth/login

**接口描述：** 用户登录

**请求参数：**
```json
{
  "username": "zhangsan",
  "password": "123456"
}
```

**响应示例：**
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userInfo": {
      "id": 1,
      "username": "zhangsan",
      "realName": "张三",
      "roleId": 1,
      "roleName": "销售代表"
    }
  }
}
```

---

#### 4.2.2 客户管理接口

##### GET /api/v1/customers

**接口描述：** 分页查询客户列表

**请求参数：**

| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| page | int | query | 否 | 页码（默认 1） |
| size | int | query | 否 | 每页大小（默认 10） |
| customerName | string | query | 否 | 客户名称（模糊搜索） |
| contactName | string | query | 否 | 联系人姓名（模糊搜索） |
| contactPhone | string | query | 否 | 联系电话（模糊搜索） |
| customerStatus | string | query | 否 | 客户状态 |
| customerSource | string | query | 否 | 客户来源 |
| sortField | string | query | 否 | 排序字段（默认 createTime） |
| sortOrder | string | query | 否 | 排序方向（asc/desc，默认 desc） |

**响应示例：**
```json
{
  "code": 200,
  "message": "查询成功",
  "data": {
    "records": [
      {
        "id": 1,
        "customerName": "阿里巴巴集团",
        "contactName": "张三",
        "contactPhone": "13800138000",
        "contactEmail": "zhangsan@alibaba.com",
        "companyAddress": "杭州市余杭区",
        "customerSource": "线上推广",
        "customerStatus": "意向客户",
        "remark": "",
        "createTime": "2026-01-12T10:00:00+08:00"
      }
    ],
    "total": 100,
    "size": 10,
    "current": 1,
    "pages": 10
  }
}
```

---

##### GET /api/v1/customers/{id}

**接口描述：** 获取客户详情

**路径参数：**
- `id`: 客户 ID

**响应示例：**
```json
{
  "code": 200,
  "message": "查询成功",
  "data": {
    "id": 1,
    "customerName": "阿里巴巴集团",
    "contactName": "张三",
    "contactPhone": "13800138000",
    "contactEmail": "zhangsan@alibaba.com",
    "companyAddress": "杭州市余杭区",
    "customerSource": "线上推广",
    "customerStatus": "意向客户",
    "remark": "",
    "createTime": "2026-01-12T10:00:00+08:00",
    "updateTime": "2026-01-12T10:00:00+08:00",
    "followUps": [
      {
        "id": 1,
        "followUpContent": "初步沟通，了解客户需求",
        "followUpMethod": "电话",
        "followUpPerson": "张三",
        "createTime": "2026-01-12T10:00:00+08:00"
      }
    ],
    "opportunities": [
      {
        "id": 1,
        "opportunityName": "CRM 系统采购",
        "estimatedAmount": 50000.00,
        "estimatedCloseDate": "2026-03-01",
        "salesStage": "方案报价"
      }
    ]
  }
}
```

---

##### POST /api/v1/customers

**接口描述：** 新增客户

**请求参数：**
```json
{
  "customerName": "阿里巴巴集团",
  "contactName": "张三",
  "contactPhone": "13800138000",
  "contactEmail": "zhangsan@alibaba.com",
  "companyAddress": "杭州市余杭区",
  "customerSource": "线上推广",
  "customerStatus": "潜在客户",
  "remark": ""
}
```

**响应示例：**
```json
{
  "code": 201,
  "message": "创建成功",
  "data": {
    "id": 1
  }
}
```

---

##### PUT /api/v1/customers/{id}

**接口描述：** 编辑客户

**路径参数：**
- `id`: 客户 ID

**请求参数：**
```json
{
  "customerName": "阿里巴巴集团",
  "contactName": "李四",
  "contactPhone": "13800138001",
  "contactEmail": "lisi@alibaba.com",
  "companyAddress": "杭州市滨江区",
  "customerSource": "客户转介绍",
  "customerStatus": "意向客户",
  "remark": "已跟进两次"
}
```

**响应示例：**
```json
{
  "code": 200,
  "message": "更新成功",
  "data": null
}
```

---

##### DELETE /api/v1/customers/{id}

**接口描述：** 删除客户

**路径参数：**
- `id`: 客户 ID

**响应示例：**
```json
{
  "code": 200,
  "message": "删除成功",
  "data": null
}
```

---

#### 4.2.3 跟进记录接口

##### GET /api/v1/follow-ups

**接口描述：** 查询跟进记录列表（按客户筛选）

**请求参数：**

| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| page | int | query | 否 | 页码（默认 1） |
| size | int | query | 否 | 每页大小（默认 10） |
| customerId | long | query | 是 | 客户 ID |

**响应示例：**
```json
{
  "code": 200,
  "message": "查询成功",
  "data": {
    "records": [
      {
        "id": 1,
        "customerId": 1,
        "customerName": "阿里巴巴集团",
        "followUpContent": "初步沟通，了解客户需求",
        "followUpMethod": "电话",
        "nextFollowUpTime": "2026-01-15T10:00:00+08:00",
        "followUpPerson": "张三",
        "createTime": "2026-01-12T10:00:00+08:00"
      }
    ],
    "total": 20,
    "size": 10,
    "current": 1,
    "pages": 2
  }
}
```

---

##### GET /api/v1/follow-ups/reminders

**接口描述：** 查询跟进提醒（今天需要跟进的客户）

**请求参数：** 无

**响应示例：**
```json
{
  "code": 200,
  "message": "查询成功",
  "data": {
    "records": [
      {
        "customerId": 1,
        "customerName": "阿里巴巴集团",
        "contactName": "张三",
        "contactPhone": "13800138000",
        "lastFollowUpContent": "初步沟通，了解客户需求",
        "nextFollowUpTime": "2026-01-12T10:00:00+08:00"
      }
    ],
    "total": 5
  }
}
```

---

##### POST /api/v1/follow-ups

**接口描述：** 新增跟进记录

**请求参数：**
```json
{
  "customerId": 1,
  "followUpContent": "第二次沟通，发送产品资料",
  "followUpMethod": "微信",
  "nextFollowUpTime": "2026-01-15T10:00:00+08:00"
}
```

**响应示例：**
```json
{
  "code": 201,
  "message": "创建成功",
  "data": {
    "id": 2
  }
}
```

---

##### PUT /api/v1/follow-ups/{id}

**接口描述：** 编辑跟进记录

**路径参数：**
- `id`: 跟进记录 ID

**请求参数：**
```json
{
  "followUpContent": "第二次沟通，发送产品资料和报价单",
  "nextFollowUpTime": "2026-01-16T10:00:00+08:00"
}
```

---

##### DELETE /api/v1/follow-ups/{id}

**接口描述：** 删除跟进记录

**路径参数：**
- `id`: 跟进记录 ID

---

#### 4.2.4 销售机会接口

##### GET /api/v1/opportunities

**接口描述：** 分页查询销售机会

**请求参数：**

| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| page | int | query | 否 | 页码（默认 1） |
| size | int | query | 否 | 每页大小（默认 10） |
| customerId | long | query | 否 | 客户 ID |
| salesStage | string | query | 否 | 销售阶段 |
| startDate | date | query | 否 | 预计成交日期-开始 |
| endDate | date | query | 否 | 预计成交日期-结束 |

**响应示例：**
```json
{
  "code": 200,
  "message": "查询成功",
  "data": {
    "records": [
      {
        "id": 1,
        "customerId": 1,
        "customerName": "阿里巴巴集团",
        "opportunityName": "CRM 系统采购",
        "estimatedAmount": 50000.00,
        "estimatedCloseDate": "2026-03-01",
        "salesStage": "方案报价",
        "probability": 60,
        "remark": ""
      }
    ],
    "total": 50,
    "size": 10,
    "current": 1,
    "pages": 5
  }
}
```

---

##### GET /api/v1/opportunities/funnel

**接口描述：** 销售漏斗统计

**响应示例：**
```json
{
  "code": 200,
  "message": "查询成功",
  "data": [
    {
      "salesStage": "线索确认",
      "stageLabel": "线索确认",
      "count": 10,
      "totalAmount": 200000.00,
      "weightedAmount": 40000.00
    },
    {
      "salesStage": "需求分析",
      "stageLabel": "需求分析",
      "count": 8,
      "totalAmount": 300000.00,
      "weightedAmount": 120000.00
    },
    {
      "salesStage": "方案报价",
      "stageLabel": "方案报价",
      "count": 5,
      "totalAmount": 250000.00,
      "weightedAmount": 150000.00
    }
  ]
}
```

---

##### POST /api/v1/opportunities

**接口描述：** 新增销售机会

**请求参数：**
```json
{
  "customerId": 1,
  "opportunityName": "CRM 系统采购",
  "estimatedAmount": 50000.00,
  "estimatedCloseDate": "2026-03-01",
  "salesStage": "线索确认",
  "probability": 20,
  "remark": ""
}
```

---

##### PUT /api/v1/opportunities/{id}

**接口描述：** 编辑销售机会

---

##### PUT /api/v1/opportunities/{id}/advance-stage

**接口描述：** 推进销售阶段

**路径参数：**
- `id`: 机会 ID

**请求参数：**
```json
{
  "newStage": "需求分析"
}
```

---

##### DELETE /api/v1/opportunities/{id}

**接口描述：** 删除销售机会

---

#### 4.2.5 用户管理接口

##### GET /api/v1/users

**接口描述：** 分页查询用户列表

**请求参数：**

| 参数名 | 类型 | 位置 | 必填 | 说明 |
|--------|------|------|------|------|
| page | int | query | 否 | 页码（默认 1） |
| size | int | query | 否 | 每页大小（默认 10） |
| username | string | query | 否 | 用户名（模糊搜索） |
| realName | string | query | 否 | 真实姓名（模糊搜索） |
| status | int | query | 否 | 状态（1:启用 0:禁用） |

---

##### POST /api/v1/users

**接口描述：** 新增用户

**请求参数：**
```json
{
  "username": "lisi",
  "password": "123456",
  "realName": "李四",
  "phone": "13900139000",
  "email": "lisi@example.com",
  "roleId": 1
}
```

---

##### PUT /api/v1/users/{id}

**接口描述：** 编辑用户

---

##### POST /api/v1/users/{id}/reset-password

**接口描述：** 重置用户密码

**请求参数：**
```json
{
  "newPassword": "654321"
}
```

---

##### DELETE /api/v1/users/{id}

**接口描述：** 删除用户

---

#### 4.2.6 数据字典接口

##### GET /api/v1/dict/{dictType}

**接口描述：** 根据字典类型查询字典列表

**路径参数：**
- `dictType`: 字典类型（如 `customer_status`）

**响应示例：**
```json
{
  "code": 200,
  "message": "查询成功",
  "data": [
    {
      "dictValue": "POTENTIAL",
      "dictLabel": "潜在客户"
    },
    {
      "dictValue": "INTENTION",
      "dictLabel": "意向客户"
    }
  ]
}
```

---

### 4.3 错误码定义

| 错误码 | 说明 | HTTP 状态码 |
|--------|------|-------------|
| 200 | 操作成功 | 200 |
| 201 | 创建成功 | 201 |
| 400 | 请求参数错误 | 400 |
| 401 | 未授权（Token 无效或过期） | 401 |
| 403 | 禁止访问（权限不足） | 403 |
| 404 | 资源不存在 | 404 |
| 409 | 资源冲突（如用户名已存在） | 409 |
| 500 | 服务器内部错误 | 500 |
| 10001 | 用户名或密码错误 | 400 |
| 10002 | 用户名已存在 | 409 |
| 10003 | 用户已被禁用 | 403 |
| 10004 | Token 已过期 | 401 |
| 20001 | 客户不存在 | 404 |
| 20002 | 客户有关联数据，无法删除 | 409 |
| 30001 | 跟进记录不存在 | 404 |
| 40001 | 销售机会不存在 | 404 |
| 50001 | 数据字典不存在 | 404 |

---

## 5. 业务流程设计

### 5.1 客户创建流程

**流程触发条件：** 销售代表获取新客户线索

**流程步骤：**
1. **填写客户信息**
   - 输入：客户名称、联系人、电话、邮箱、地址、来源、状态
   - 输出：客户基本信息

2. **数据校验**
   - 校验规则：
     - 必填字段非空
     - 手机号格式正确
     - 邮箱格式正确（如果提供）
   - 异常处理：返回 400 错误，提示具体错误信息

3. **保存客户数据**
   - 操作：插入 crm_customer 表
   - 异常处理：返回 500 错误，记录日志

4. **返回客户 ID**
   - 输出：新创建的客户 ID

**流程图：**
```
[开始] → [填写客户信息] → [数据校验]
                              ↓
                        校验通过？
                         ↙      ↘
                       是        否
                       ↓         ↓
                  [保存数据]  [返回错误]
                       ↓
                  [返回客户 ID]
                       ↓
                     [结束]
```

---

### 5.2 客户删除流程

**流程触发条件：** 用户请求删除客户

**流程步骤：**
1. **检查客户是否存在**
   - 输入：客户 ID
   - 输出：客户信息
   - 异常处理：客户不存在，返回 404

2. **检查关联数据**
   - 操作：查询跟进记录表、销售机会表
   - 判断：是否存在关联数据
   - 异常处理：存在关联数据，返回 409 错误

3. **执行软删除**
   - 操作：更新 `is_deleted = 1`
   - 异常处理：返回 500 错误，记录日志

4. **级联删除关联数据**
   - 操作：更新关联的跟进记录、销售机会的 `is_deleted = 1`
   - 异常处理：返回 500 错误，记录日志

5. **返回成功**
   - 输出：操作成功

**流程图：**
```
[开始] → [客户存在?] → [有关联数据?] → [软删除客户] → [级联删除关联] → [返回成功]
              ↓              ↓
            不存在          存在
              ↓              ↓
         [返回404]      [返回409]
```

---

### 5.3 登录认证流程

**流程触发条件：** 用户访问登录接口

**流程步骤：**
1. **验证用户名和密码**
   - 输入：用户名、密码
   - 操作：查询 crm_user 表
   - 判断：用户是否存在，密码是否匹配
   - 异常处理：
     - 用户不存在：返回 10001 错误
     - 密码错误：返回 10001 错误

2. **检查用户状态**
   - 判断：`status = 1`（启用）
   - 异常处理：用户已禁用，返回 10003 错误

3. **生成 JWT Token**
   - 操作：使用 `jjwt` 库生成 Token
   - Token 内容：
     ```json
     {
       "userId": 1,
       "username": "zhangsan",
       "roleId": 1,
       "exp": 1736784000
     }
     ```

4. **记录登录日志**
   - 操作：插入登录日志表（可选）
   - 内容：用户 ID、登录时间、IP 地址

5. **返回 Token 和用户信息**
   - 输出：Token、用户基本信息

**流程图：**
```
[开始] → [验证用户名密码] → [用户存在?]
                              ↓
                         密码正确?
                          ↙      ↘
                        是        否
                        ↓         ↓
                  [检查状态]  [返回错误]
                        ↓
                    状态启用?
                     ↙      ↘
                   是        否
                   ↓         ↓
             [生成Token]  [返回错误]
                   ↓
             [记录登录日志]
                   ↓
              [返回Token]
                   ↓
                 [结束]
```

---

### 5.4 销售阶段推进流程

**流程触发条件：** 用户请求推进销售阶段

**流程步骤：**
1. **检查机会是否存在**
   - 输入：机会 ID
   - 异常处理：机会不存在，返回 404

2. **验证新阶段**
   - 判断：新阶段是否合法（在数据字典中存在）
   - 异常处理：阶段不合法，返回 400 错误

3. **检查阶段顺序**
   - 判断：新阶段是否在当前阶段之后
   - 异常处理：阶段顺序错误，返回 400 错误

4. **更新销售阶段**
   - 操作：更新 `sales_stage` 字段
   - 异常处理：返回 500 错误

5. **返回成功**
   - 输出：更新后的机会信息

---

### 5.5 跟进提醒查询流程

**流程触发条件：** 用户查询今天需要跟进的客户

**流程步骤：**
1. **查询跟进提醒**
   - 操作：查询 crm_follow_up 表
   - 条件：
     - `next_follow_up_time <= 今天 23:59:59`
     - `is_deleted = 0`
   - 排序：按 `next_follow_up_time` 升序

2. **关联查询客户信息**
   - 操作：JOIN crm_customer 表
   - 获取：客户名称、联系人、电话

3. **返回提醒列表**
   - 输出：客户列表和下次跟进时间

---

## 6. 非功能性设计

### 6.1 性能设计

**性能目标：**
- API 响应时间 < 500ms (P95)
- 支持 100+ 并发用户
- 数据库查询 < 300ms

**优化策略：**

1. **数据库索引优化**
   - 为所有外键创建索引
   - 为常用查询字段创建索引（如 `customer_name`、`contact_phone`）
   - 为排序字段创建索引（如 `create_time`）

2. **分页查询**
   - 使用 MyBatis-Plus 分页插件
   - 避免深度分页（限制最大页码）

3. **缓存机制**
   - 数据字典缓存（Redis）
   - 用户信息缓存（Redis）
   - 热点客户数据缓存（可选）

4. **SQL 优化**
   - 避免 `SELECT *`，只查询需要的字段
   - 避免在循环中查询数据库（N+1 问题）
   - 使用批量查询代替单条查询

5. **异步处理**
   - 登录日志异步写入
   - 操作日志异步写入（可选）

---

### 6.2 安全设计

**认证授权：**
- JWT Token 认证
- Token 有效期 24 小时
- 基于角色的权限控制（RBAC）
- API 接口级别权限验证

**数据加密：**
- 密码使用 BCrypt 加密（强度 10）
- 敏感数据脱敏显示
- HTTPS 传输加密

**安全防护：**
- SQL 注入防护：使用预编译语句
- XSS 防护：输入参数校验和过滤
- CSRF 防护：Token 验证
- 请求限流：防止暴力攻击

---

### 6.3 可扩展性设计

**扩展点：**
- 新增业务模块（如订单管理）
- 新增数据字段（通过 JSON 字段扩展）
- 新增 API 接口版本

**扩展机制：**
- 模块化设计，新模块独立开发
- 接口版本管理，向后兼容
- 配置外部化，支持动态配置

---

### 6.4 可维护性设计

**日志规范：**
- 使用 Slf4j + Logback
- 日志级别：ERROR、WARN、INFO、DEBUG
- 日志格式：`[时间] [级别] [类名] [操作] [参数]`
- 关键操作记录 INFO 日志
- 异常记录 ERROR 日志（含堆栈）

**监控指标：**
- API 响应时间（P50、P95、P99）
- API 错误率
- 数据库连接池使用率
- JVM 内存使用率
- 系统吞吐量（QPS、TPS）

**告警规则：**
- API 错误率 > 1%：发送告警
- API 响应时间 P95 > 1s：发送告警
- 数据库连接池使用率 > 80%：发送告警
- 系统可用性 < 99%：发送告警

---

## 7. 技术实现要点

### 7.1 关键技术点

#### 7.1.1 统一响应封装

```java
@Data
public class Result<T> {
    private Integer code;
    private String message;
    private T data;

    public static <T> Result<T> success(T data) {
        Result<T> result = new Result<>();
        result.setCode(200);
        result.setMessage("操作成功");
        result.setData(data);
        return result;
    }

    public static <T> Result<T> error(Integer code, String message) {
        Result<T> result = new Result<>();
        result.setCode(code);
        result.setMessage(message);
        return result;
    }
}
```

#### 7.1.2 统一异常处理

```java
@RestControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(BusinessException.class)
    public Result<?> handleBusinessException(BusinessException e) {
        log.error("业务异常：{}", e.getMessage());
        return Result.error(e.getCode(), e.getMessage());
    }

    @ExceptionHandler(Exception.class)
    public Result<?> handleException(Exception e) {
        log.error("系统异常", e);
        return Result.error(500, "系统异常，请稍后重试");
    }
}
```

#### 7.1.3 JWT Token 工具类

```java
public class JwtUtil {
    private static final String SECRET_KEY = "your-secret-key";
    private static final long EXPIRATION = 24 * 60 * 60 * 1000; // 24小时

    public static String generateToken(User user) {
        Date now = new Date();
        Date expiration = new Date(now.getTime() + EXPIRATION);

        return Jwts.builder()
                .setSubject(user.getUsername())
                .claim("userId", user.getId())
                .claim("roleId", user.getRoleId())
                .setIssuedAt(now)
                .setExpiration(expiration)
                .signWith(SignatureAlgorithm.HS256, SECRET_KEY)
                .compact();
    }

    public static Claims parseToken(String token) {
        return Jwts.parser()
                .setSigningKey(SECRET_KEY)
                .parseClaimsJws(token)
                .getBody();
    }
}
```

#### 7.1.4 乐观锁实现

使用 MyBatis-Plus 乐观锁插件：

```java
@Configuration
public class MyBatisPlusConfig {
    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor() {
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
        interceptor.addInnerInterceptor(new OptimisticLockerInnerInterceptor());
        return interceptor;
    }
}
```

实体类添加 version 字段：

```java
@Data
@TableName("crm_customer")
public class Customer {
    @TableId(type = IdType.ASSIGN_ID)
    private Long id;

    // ... 其他字段

    @Version
    private Integer version;
}
```

#### 7.1.5 软删除实现

使用 MyBatis-Plus 逻辑删除：

```java
@Data
@TableName("crm_customer")
public class Customer {
    // ... 其他字段

    @TableLogic
    private Integer isDeleted;
}
```

配置文件：

```yaml
mybatis-plus:
  global-config:
    db-config:
      logic-delete-field: isDeleted
      logic-delete-value: 1
      logic-not-delete-value: 0
```

---

### 7.2 技术难点和解决方案

#### 7.2.1 并发修改冲突

**难点：** 多个用户同时修改同一客户数据，可能导致数据不一致。

**解决方案：** 使用乐观锁（version 字段）
- 更新时自动检查版本号
- 版本不匹配时抛出异常
- 前端提示用户重新获取数据

#### 7.2.2 大数据量分页性能

**难点：** 深度分页（如查询第 10000 页）性能低下。

**解决方案：**
- 限制最大页码（如最多查询 100 页）
- 使用游标分页（基于 ID 或时间）
- 使用 Elasticsearch 搜索（未来版本）

#### 7.2.3 数据字典缓存一致性

**难点：** 数据字典更新后，缓存未及时刷新。

**解决方案：**
- 更新字典时清除缓存（`@CacheEvict`）
- 设置缓存过期时间（30 分钟）
- 提供手动刷新缓存的接口

---

### 7.3 代码组织结构

```
crm-system/
├── crm-common/
│   ├── crm-common-core/
│   │   ├── src/main/java/com/crm/common/core/
│   │   │   ├── domain/          # 实体基类
│   │   │   ├── exception/       # 自定义异常
│   │   │   ├── result/          # 统一响应
│   │   │   └── util/            # 工具类
│   │   └── pom.xml
│   │
│   ├── crm-common-security/
│   │   ├── src/main/java/com/crm/common/security/
│   │   │   ├── annotation/      # 权限注解
│   │   │   ├── filter/          # JWT 过滤器
│   │   │   ├── utils/           # JWT 工具
│   │   │   └── Authentication   # 认证信息
│   │   └── pom.xml
│   │
│   └── crm-common-web/
│       ├── src/main/java/com/crm/common/web/
│       │   ├── config/          # Web 配置
│       │   ├── interceptor/     # 拦截器
│       │   └── handler/         # 全局异常处理
│       └── pom.xml
│
├── crm-api/
│   ├── crm-api-customer/
│   │   ├── src/main/java/com/crm/api/customer/
│   │   │   ├── dto/             # 数据传输对象
│   │   │   ├── vo/              # 视图对象
│   │   │   ├── feign/           # Feign 客户端（未来）
│   │   │   └── fallback/        # 降级处理（未来）
│   │   └── pom.xml
│   │
│   └── crm-api-system/
│       └── ... (类似结构)
│
└── crm-business/
    ├── crm-customer/
    │   ├── crm-customer-biz/
    │   │   ├── src/main/java/com/crm/customer/
    │   │   │   ├── controller/  # 控制器
    │   │   │   ├── service/     # 业务逻辑
    │   │   │   │   ├── impl/
    │   │   │   ├── mapper/      # 数据访问
    │   │   │   ├── domain/      # 实体类
    │   │   │   └── converter/   # 对象转换
    │   │   └── pom.xml
    │   │
    │   └── crm-customer-api/     # API 定义
    │
    ├── crm-followup/
    │   └── ... (类似结构)
    │
    ├── crm-opportunity/
    │   └── ... (类似结构)
    │
    └── crm-system/
        └── ... (类似结构)
```

---

## 8. 测试策略

### 8.1 单元测试

**测试框架：** JUnit 5 + Mockito

**覆盖率目标：** ≥ 80%

**测试范围：**
- Service 层业务逻辑
- Utils 工具类
- Converter 转换器

**示例：**
```java
@SpringBootTest
class CustomerServiceTest {
    @Autowired
    private CustomerService customerService;

    @Test
    void testCreateCustomer() {
        // Given
        CustomerDTO customerDTO = new CustomerDTO();
        customerDTO.setCustomerName("测试客户");
        // ... 设置其他字段

        // When
        Long customerId = customerService.createCustomer(customerDTO);

        // Then
        assertNotNull(customerId);
        Customer customer = customerService.getById(customerId);
        assertEquals("测试客户", customer.getCustomerName());
    }
}
```

---

### 8.2 集成测试

**测试场景：**
- 客户创建 → 查询 → 编辑 → 删除
- 跟进记录创建和查询
- 销售机会创建和销售漏斗统计
- 用户登录和权限验证

**测试环境：** H2 内存数据库

---

### 8.3 性能测试

**测试工具：** JMeter

**性能指标：**
- 并发用户：100
- 响应时间 P95 < 500ms
- 错误率 < 0.1%

**测试场景：**
- 查询客户列表（分页）
- 创建客户
- 查询跟进记录

---

## 9. 部署方案

### 9.1 部署架构

```
┌─────────────┐
│  Nginx/LB   │ (负载均衡)
└──────┬──────┘
       │
   ┌───┴───┐
   │       │
┌──┴──┐ ┌──┴──┐
│ App │ │ App │ (应用服务器集群)
│  1  │ │  2  │
└──┬──┘ └──┬──┘
   │       │
   └───┬───┘
       │
  ┌────┴────┐
  │  MySQL  │ (主数据库)
  │ Primary │
  └─────────┘
       │
  ┌────┴────┐
  │  MySQL  │ (从数据库，可选)
  │  Slave  │
  └─────────┘

  ┌─────────┐
  │  Redis  │ (缓存，可选)
  └─────────┘
```

---

### 9.2 部署步骤

1. **环境准备**
   - 安装 JDK 8+
   - 安装 MySQL 8.0
   - 安装 Redis 6.x（可选）

2. **数据库初始化**
   - 执行建表 SQL
   - 导入初始数据（角色、字典）

3. **应用部署**
   - 打包：`mvn clean package`
   - 启动：`java -jar crm-system.jar`

4. **健康检查**
   - 访问：`http://localhost:8080/actuator/health`
   - 预期返回：`{"status":"UP"}`

---

### 9.3 回滚方案

1. **保留上一版本**
   - 备份旧版本 JAR 包
   - 备份数据库（数据快照）

2. **快速回滚**
   - 停止新版本应用
   - 启动旧版本应用
   - 恢复数据库（如需要）

3. **验证回滚**
   - 健康检查
   - 功能测试

---

## 10. 附录

### 10.1 术语表

| 术语 | 说明 |
|------|------|
| **DTO** | Data Transfer Object，数据传输对象 |
| **VO** | View Object，视图对象 |
| **RBAC** | Role-Based Access Control，基于角色的访问控制 |
| **JWT** | JSON Web Token，JSON 格式的令牌 |
| **BCrypt** | 一种密码哈希算法 |
| **ERP** | Enterprise Resource Planning，企业资源计划 |
| **BI** | Business Intelligence，商业智能 |

---

### 10.2 参考资料

**技术文档：**
- [Spring Boot 官方文档](https://spring.io/projects/spring-boot)
- [MyBatis-Plus 官方文档](https://baomidou.com/)
- [MySQL 官方文档](https://dev.mysql.com/doc/)
- [JWT 官方网站](https://jwt.io/)

**设计原则：**
- SOLID 原则
- DDD（领域驱动设计）
- RESTful API 设计最佳实践

---

**设计文档结束**

---

**设计检查清单：**

- [x] 设计覆盖所有需求文档中的功能点
- [x] 模块划分清晰，职责明确
- [x] 数据模型设计合理，关系清晰（6 张核心表）
- [x] API 接口定义完整，符合 RESTful 规范
- [x] 业务流程设计完整，考虑边界情况
- [x] 非功能性需求（性能、安全、可扩展性）已考虑
- [x] 设计遵循项目技术栈和规范（Spring Boot + MyBatis-Plus + MySQL）
- [x] 考虑了错误处理和异常情况
- [x] 设计文档清晰、完整、可实施
- [x] 有明确的实现路径和优先级（分阶段实施计划）

**质量评分：** ⭐⭐⭐⭐⭐ (5.0 / 5.0)

---

**下一步：** 进入编码实现阶段
